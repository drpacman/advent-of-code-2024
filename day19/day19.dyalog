ts←x⊆⍨','≠x←' '⎕R''⊃⊃⎕NGET'input'1
xs←2↓⊃⎕NGET'input'1
solve←{ 
    x←∪⊃,/{ 
        n←⍵ 
        {(≢⍵)↓n}¨ts/⍨{1≡⊃⍵⍷n}¨ts
    }¨⍵
    0≡≢x:0
    0∊≢¨x:1
    ∇x 
}

 +/solve¨⊂¨xs ⍝ Part 1

solve←{
     ⍺←0
     n←⊃+/{(2⊃⍵)×0=≢(⊃⍵)}¨⍵
     d←⊃,/{
         m n←⍵
         {(⊂(≢⍵)↓m),n}¨ts/⍨{1≡⊃⍵⍷m}¨ts
     }¨⍵
     0≡≢d:⊃(⍺+n)
     x←{
         1=≢⍵:⍵ 
         ↓,¨(⊃¨⍵){⍺,+/⍵}⌸(2⊃¨⍵)
     } d
     0∊≢¨x:1
     (⍺+n)∇x
}
 +/solve¨⊂{(⊂⍵),1}¨xs ⍝ Part 2