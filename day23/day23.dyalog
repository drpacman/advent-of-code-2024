p←{(2↑⍵) (¯2↑⍵)}¨⊃⎕NGET'input'1
m←{⍵[⍋⍵]}¨p
y←{⍺,6=≢⍵}⌸{⍵[⍋⍵]}¨x/⍨{3=≢⍵}¨x←∪¨,m∘.,m
+/{∨/{'t'=⊃⍵}¨⍵}¨y[;2]/y[;1] ⍝ Part 1

p←⊃,/{(⊂(¯2↑⍵) (2↑⍵)),(⊂(2↑⍵) (¯2↑⍵))}¨⊃⎕NGET'input'1
y←(⊃¨p){(⊃⍺) (⍵[⍋⍵])}⌸(2⊃¨p)
lookup←{⊃y[y[;1]⍳⊂⍵;2]}
ans←{n←⊃∩/lookup¨⍵ ⋄ 0=≢n: ⍵ ⋄ ∇⍵,⊂⊃n}¨,⊂¨y[;1]
⊃{⍺,',',⍵}/⊃ans[(⊢⍳⌈/)≢¨ans] ⍝ Part 2